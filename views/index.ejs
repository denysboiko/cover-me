<!DOCTYPE html>
<html>
<head>
    <title><%- brand %></title>


    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


    <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>

    <script src="https://github.com/paulirish/infinite-scroll/blob/master/jquery.infinitescroll.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $('#content').infinitescroll({
                navSelector: "#next:last",
                nextSelector: "#next:last",
                itemSelector: "#content",
                debug: false,
                dataType: 'html',
                maxPage: 4,
                path: function(index) {
                    return "index" + index + ".html";
                }
                // appendCallback   : false, // USE FOR PREPENDING
            }, function(newElements, data, url){
                // used for prepending data
                // $(newElements).css('background-color','#ffef00');
                // $(this).prepend(newElements);
            });
        });
    </script>
    <link rel='stylesheet' href='/css/style.css'/>
    <link rel="shortcut icon" href="favicon.ico"/>
</head>
<body>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                            class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">Album title</h4>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <a href="" class="btn btn-primary" role="button" download="img.jpg">Download <span
                            class="glyphicon glyphicon-download"></span></a>
            </div>
        </div>
    </div>
</div>


<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#"><%- brand %></a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <form class="navbar-form navbar-right" role="search">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Search cover">
                </div>
                <!--<button type="submit" class="btn btn-default">Submit</button>-->
            </form>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>


<div class="container">
    <% if (cvrs.length) { %>
    <ul class="row">
        <% cvrs.forEach(function(cover){ %>
        <li class="col-lg-2 col-md-3 col-sm-3 col-xs-4">

            <figure class="cover-item"><img alt="<%= cover.get('album') %>" src="<%= cover.get('sPicture') %>"
                                            bigimg="<%= cover.get('bPicture') %>">
                <figcaption><span class="album-title"><%= cover.get('album') %></span><br>
                    by <span class="artist-name"><%= cover.get('artist') %></span></figcaption>

            </figure>
        </li>
        <% }) %>
    </ul>
    <% } %>
    <% include pagination %>
</div>

<table class="errors">
    <tbody>
    <tr>
        <td><span class="label label-error" >ERROR</span></td>
        <td class="collapse"><span class="label label-warning" >Warning</span></td>
        <td class="collapse">example error</td>
        <td class="date collapse">2013-05-26 23:54:19</td>
    </tr>
    </tbody>
</table>
<script>
    function element_in_scroll(elem)
    {
        var docViewTop = $(window).scrollTop();
        var docViewBottom = docViewTop + $(window).height();

        var elemTop = $(elem).offset().top;
        var elemBottom = elemTop + $(elem).height();

        return ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));
    }

    $(document).scroll(function(e){
        if (element_in_scroll(".errors tbody tr:last")) {
            $(document).unbind('scroll');
            $.ajax({
                type: "POST",
                url: document.location.href,
                data: { text_filter:  $('#text_filter').attr('value'), index_count:$('#index_count').attr('value'),json: "true" }
            }).done(function( msg ) {
                        $(".errors tbody ").append(msg.html);
                        $('#index_count').attr('value',msg.index_count);
                        if (msg.count != 0) {
                            $(document).scroll(function(e){
                                scroll_element_ajax();
                            })
                        }
                    });
        };
    });
</script>
<div id="posts">
    <div class="post">...</div>
    <div class="post">...</div>
</div>

<div id="pagination">
    <a href="/main" class="next">next</a>
</div>


<script>

    $(document).ready(function () {
        $('li img').on('click', function () {
            var src = $(this).attr('bigimg');
            var img = '<img src="' + src + '" class="img-responsive"/>';
            var album = $(this).attr('alt');

            $('#myModal').modal();
            $('#myModal').on('shown.bs.modal', function () {
                $('#myModal #myModalLabel').html(album);
                $('#myModal .modal-body').html(img);
                $('#myModal .modal-footer a').attr("href", src);
            });
            $('#myModal').on('hidden.bs.modal', function () {
                $('#myModal #myModalLabel').html('Album Title');
                $('#myModal .modal-body').html('');
                $('#myModal .modal-footer a').attr("href", "#");
            });
        });
    })

</script>


</body>
</html>